<div fxLayout="column" style="height: 100%; padding: 10px" *ngIf="task">
    <div fxFlex="20">
        <section fxFlex="65" fxLayout="column">
            <h3 style="margin: 0;">{{ task.name }}</h3>
            <p fxFlex style="overflow-y: auto;">
                {{ task.description }}
            </p>
        </section>
        <mat-divider vertical="true"></mat-divider>
        <section fxFlex style="overflow-y: auto;">
            <div *ngFor="let step of steps; index as i">
                <div fxLayout fxLayoutAlign="center" style="cursor: pointer; padding: 5px;"
                    [class.highlight]="selectedStep.id===step.id" (click)="viewStep(step)">
                    <div fxFlex>{{ i+1 }}. {{ step.name }}</div>
                    <mat-icon *ngIf="isAnswered(step)" color="primary">check_circle</mat-icon>
                    <mat-icon *ngIf="!isAnswered(step)">radio_button_unchecked</mat-icon>
                </div>
                <mat-divider *ngIf="i < steps.length -1"></mat-divider>
            </div>
        </section>
    </div>
    <mat-card fxFlex="55" fxLayout="column">
        <b>{{selectedStep.name}}</b>
        <div fxLayout="row" class="step-guidance">
            <div fxLayout="column" style="overflow-y: auto;">
                <markdown [data]="selectedStep.guidance"></markdown>
                <div *ngIf="selectedStep.subactivities" fxFlex>
                    <cc-subactivities [selectedStep]="selectedStep" [order]="selectedStep.order"></cc-subactivities>
                </div>
            </div>
            <div>
                <div style="padding: 0 0 10px 10px;" fxLayoutGap="10" fxLayout="row-reverse">
                    <button *ngIf="!showExample && selectedStep.examples?.length > 0" mat-flat-button color="primary"
                        (click)="showExamples()">
                        <mat-icon>photo_library</mat-icon> Primeri
                    </button>
                    <button *ngIf="showExample && selectedStep.examples?.length !== 1" mat-flat-button color="primary"
                        (click)="getNextExample()">
                        <mat-icon>image</mat-icon> Nov primer
                    </button>
                    <button *ngIf="showExample" mat-flat-button color="primary" (click)="showExample = false">
                        <mat-icon>hide_image</mat-icon> Sakrij
                    </button>
                </div>
                <youtube-player style="padding-left: 10px;" *ngIf="showExample" [width]="500" [height]="280" [videoId]="videoUrl"></youtube-player>
            </div>
        </div>
    </mat-card>
    <div fxFlex="20" fxLayout="row" fxLayoutGap="10px">
        <form [formGroup]="answerForm" *ngIf="selectedStep.submissionFormat" fxLayout="column" fxFlex>
            <b>Rešenje koraka</b>
            {{ selectedStep.submissionFormat.guidelines }}
            <mat-form-field appearance="fill">
                <mat-label>Odgovor</mat-label>
                <textarea formControlName="answer" matInput rows="6"></textarea>
            </mat-form-field>
            <div fxLayout="row-reverse">
                <button mat-flat-button color="primary" [disabled]="answerForm.invalid"
                    (click)="submitAnswer()">
                    Podnesi odgovor
                </button>
            </div>
        </form>
        <mat-divider vertical="true"></mat-divider>
        <div *ngIf="selectedStep.standards && selectedStep.standards.length > 0" fxFlex="35">
            <b>Standardi</b>
            <div *ngFor="let standard of selectedStep.standards">
                {{ standard.name }} / {{ standard.maxPoints + (standard.maxPoints === 1 ? ' bod' : ' boda') }}
            </div>
        </div>
    </div>
    <div fxLayout="row-reverse" fxLayoutGap="10">
        <button mat-flat-button fxFlex="5" color="primary" [disabled]="isLast()" (click)="nextStep()">
            <mat-icon matTooltip="Sledeći korak" [matTooltipPosition]="'above'">navigate_next</mat-icon>
        </button>
        <button mat-flat-button fxFlex="5" color="primary" [disabled]="isFirst()" (click)="previosStep()">
            <mat-icon matTooltip="Prethodni korak" [matTooltipPosition]="'above'">navigate_before</mat-icon>
        </button>
    </div>
</div>