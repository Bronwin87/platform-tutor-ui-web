<div fxLayout="row" style="height: 100%" *ngIf="task">
    <div fxFlex="15" fxLayout="column">
        <div fxFlex="1 1 auto" fxLayout="column" style="padding: 10px 0px 10px 10px;">
            <h3 style="margin: 0;">{{ task.name }}</h3>
            <p style="overflow-y: auto; max-height: 50vh; padding-right: 5px;">
                {{ task.description }}
            </p>
        </div>
        <div fxFlex="1 1 100%" style="overflow-y: auto;">
            <mat-divider></mat-divider>
            <div *ngFor="let step of steps; index as i">
                <div fxLayout fxLayoutAlign="center" style="cursor: pointer; padding: 5px;"
                    [class.highlight]="selectedStep.id===step.id" (click)="viewStep(step)">
                    <div fxFlex>{{ i+1 }}. {{ step.name }}</div>
                    <mat-icon *ngIf="isAnswered(step)" color="primary">check_circle</mat-icon>
                    <mat-icon *ngIf="!isAnswered(step)">radio_button_unchecked</mat-icon>
                </div>
                <mat-divider *ngIf="i < steps.length -1"></mat-divider>
            </div>
        </div>
    </div>
    <mat-divider style="border-width: 5px;" vertical="true"></mat-divider>
    <div fxFlex="85" fxLayout="column" style="padding: 10px">
        <div fxLayout="row" fxLayoutAlign=" center">
            <b>{{selectedStep.name}}</b>
            <span fxFlex></span>
            <span style="padding-bottom: 10px" fxLayoutGap="10" fxLayout="row-reverse">
                <button *ngIf="!showExample && selectedStep.examples?.length > 0" mat-flat-button color="primary"
                    (click)="showExamples()">
                    <mat-icon>photo_library</mat-icon> Primeri
                </button>
                <button *ngIf="showExample && selectedStep.examples?.length !== 1" mat-flat-button color="primary"
                    (click)="getNextExample()">
                    <mat-icon>image</mat-icon> Nov primer
                </button>
                <button *ngIf="showExample" mat-flat-button color="primary" (click)="showExample = false">
                    <mat-icon>hide_image</mat-icon> Sakrij
                </button>
            </span>
        </div>
        <div fxFlex="67" fxLayout="row">
            <div fxLayout="column" style="overflow-y: auto;" fxFlex>
                <markdown [data]="selectedStep.guidance"></markdown>
                <div *ngIf="selectedStep.subactivities" fxFlex>
                    <cc-subactivities [selectedStep]="selectedStep" [order]="selectedStep.order"></cc-subactivities>
                </div>
            </div>
            <div>
                <youtube-player style="padding-left: 10px;" *ngIf="showExample" [width]="500" [height]="280" [videoId]="videoUrl"></youtube-player>
            </div>
        </div>
        <mat-divider style="border-width: 3px;"></mat-divider>
        <div fxFlex="25" fxLayout="row" fxLayoutGap="10px" style="margin-top: 10px; overflow-y: auto;">
            <div *ngIf="selectedStep.standards && selectedStep.standards.length > 0" fxFlex="30">
                <b>Standardi</b>
                <div *ngFor="let standard of selectedStep.standards">
                    {{ standard.name }} / {{ standard.maxPoints + (standard.maxPoints === 1 ? ' bod' : ' boda') }}
                </div>
            </div>
            <mat-divider vertical="true"></mat-divider>
            <form [formGroup]="answerForm" *ngIf="selectedStep.submissionFormat" fxLayout="column" fxFlex>
                <b>Rešenje koraka</b>
                {{ selectedStep.submissionFormat.guidelines }}
                <mat-form-field appearance="fill">
                    <mat-label>Odgovor</mat-label>
                    <textarea formControlName="answer" matInput rows="3"></textarea>
                </mat-form-field>
                <div fxLayout="row-reverse" fxLayoutGap="5px">
                    <button mat-flat-button fxFlex="5" color="primary" [disabled]="isLast()" (click)="nextStep()">
                        <mat-icon matTooltip="Sledeći korak" [matTooltipPosition]="'above'">navigate_next</mat-icon>
                    </button>
                    <button mat-flat-button fxFlex="5" color="primary" [disabled]="isFirst()" (click)="previosStep()">
                        <mat-icon matTooltip="Prethodni korak" [matTooltipPosition]="'above'">navigate_before</mat-icon>
                    </button>
                    <button mat-flat-button color="primary" [disabled]="answerForm.invalid"
                        (click)="submitAnswer()">
                        Podnesi odgovor
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>